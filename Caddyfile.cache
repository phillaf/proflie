{
    # Use staging endpoint for testing (to avoid rate limits)
    acme_ca {$ACME_CA:}
    
    # Order is important - cache must come before reverse_proxy
    order cache before reverse_proxy
}

{$DOMAIN:localhost} {
    # Enable caching
    cache {
        ttl {$CACHE_TTL:1m}
        stale {$CACHE_STALE:24h}
    }
    
    reverse_proxy web:3000
    
    # Nginx-style access logs
    log {
        output file /var/log/caddy/access.log {
            roll_size 100mb
            roll_keep 10
        }
        format json
    }
}
